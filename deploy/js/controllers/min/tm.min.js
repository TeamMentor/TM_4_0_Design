var app=angular.module("tm",["ngSanitize"]);app.factory("TMService",function(e,t){return{ProcessHttpRequest:function(){return t.all([e.get("/rest/library/eb39d862-f752-4d1c-ab6e-14ed697397c0",{cache:!0}),e.post("/Aspx_Pages/TM_WebServices.asmx/GetGUIObjects",{headers:{"Content-Type":"application/json"}})])},fetchArticleContent:function(a){var n="/Aspx_Pages/TM_WebServices.asmx/GetGuidanceItemHtml";return t.all(e({url:n,method:"POST",data:{guidanceItemId:a},headers:{"Content-Type":"application/json"}}))}}}),app.controller("libraryController",function(e,t,a,n){e.fetched=!0,e.isCollapsed=!0,n.ProcessHttpRequest().then(function(t){var a=t[0].data,n=t[1].data,r=getArticlesMetadata(n);e.tmLibrary=getLibrary(a,r),e.rendered=!0}),e.getContentAsync=function(t,r){var i="<h1> "+r+" </h1>";n.fetchArticleContent(t).then(function(t){e.payload=i.concat(t.data.d.toString()),e.body=a.trustAsHtml(e.payload)})}}),getArticlesMetadata=function(e){var t={},a=e.d.GuidanceItemsMappings,n=e.d.UniqueStrings;return t._numberOfArticles=0,angular.forEach(a,function(e){var a=e.split(","),r={Id:n[a[0]],Title:n[a[2]],Technology:n[a[3]],Phase:n[a[4]],Type:n[a[5]],Category:n[a[6]]};t[r.Id]=r,t._numberOfArticles++}),t},getLibrary=function(e,t){var a={Title:e.name,Folders:[],Views:[],Articles:{}},n=e.views;return angular.forEach(n,function(e){var n={Title:e.caption,Articles:[]};angular.forEach(e.guidanceItems,function(e){var r=t[e];n.Articles.push(r),a.Articles[r.Id]=r}),a.Views.push(n)}),a};